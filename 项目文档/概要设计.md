# 概要设计

## 1.引言

### 1.1编写目的

本文档主要针对在线考试系统的总体设计提出要求，同时它还将作为该产品详细设计与开发的重要参考依据。

### 1.2背景

该项目前端是基于微信小程序，后端基于springboot的云服务的考试系统。基于微信小程序的特点，我们的小程序应做到即用即走，即启即用，因此在该系统中我们将采用另外一种体系来组合用户。我们扩充我们的用户，不仅仅限制于学生，而转变为社会上的多数群体。因为在很多企业公司和产业中定期的考核培训也是必须的。

### 1.3参考资料

《spring实战(第4版)》

《软件工程导论》

《面向对象分析与设计（uml版）》

### 1.4项目风险

首要风险承担者包括：

任务提出者；
软件开发者；
产品使用者。

### 1.5预期读者

开发人员；
项目经理；
营销人员；
测试人员；
文档编写人员。

### 1.6范围

本文档包含以下部分：
1.	引言
2.	设计概述
3.	系统逻辑设计
4.	系统出错处理设计
5.	技术设计
6.	数据库设计
7.	进度计划

## 2.设计概述

### 限制和约束

●	当前时代下，pc web端已经不再占有主流地位，手机的普及与使用越来越大，因此该应用的客户端前端采用的是微信小程序的形式。

●	因为微信小程序的用户注册认证等机制需要调用腾讯提供的接口，同时，小程序还提供云服务的功能，所以应结合相应接口与云服务设计底层业务逻辑。

●	管理员作为主要的人员审核管理和试题管理者，其在手机端上进行增删改查操作并不是非常方便，所以管理员端页面采用web网页。

●	考试平台其用户量小于网课平台，但学生流量也很大，因此需要满足在高峰值流量下的可用性，采用nginx作为负载平衡服务器，多个tomcat容器进行配合。

●	在考试过程中退出是高概率发生事件，在应用中应存在保护机制，防止学生中断答题过程。同样也应该保护老师的出卷过程。

### 设计原则和设计要求

●	本产品的设计过程应该采用面向对象方法进行设计，其对象主要是二者：用户和管理员。用户本身兼有答题者和出题者两者角色，根据场景不同进行切换。

●	系统主要是建立在mvc构建上，通过前后端分离达到视图层与其余层相分离。因此前后端的交流，主要通过设计接口实现。
●	采用负载平衡后，要重新设计session机制，将其与redis缓存相结合。

●	用户作为学生的行为有：

1.  答题（可以通过主页进入或者二维码，进入试卷并完成，只有规定时间以外无法进入）
2.  查看成绩及对错情况（如有主观题需要等待批改，如果无则在考试结束后直接显示）|数据库中应该有三位标志位（是否批改，是否完成，是否有主观题）|
3.  加入群组（加入老师创建的群组）
4.  退出群组

●	作为教师行为：

1.  创建群组（通过uuid和二维码进行分享）
2.  生成试卷（通过题库添加或者自己出题）
3.  发布试卷（生成约束条件，和指定人群，如教师所在若干组别或者二维码分享）
4.  批改试卷并查看题目统计（在试题结束时间后可进入）
5.  解散群组（解除一个群组关系）

●	作为管理员的行为：
1.	进行人员的管理
2.	进行群组的管理
3.	进行试题库的管理

## 3.时间规划（大致）

|第一周|第二周|第三周|第四周|第五周|第六周|第七周|第八周|第九周|第十周|第十一周|第十二周|第十三周|第十四周|
|--|--|--|--|--|--|--|--|--|--|--|--|--|--|
|初步讨论|初步讨论|原型设计/数据库设计|原型设计/数据库设计|原型设计/数据库设计|原型设计/后端设计|原型设计/微开发学习|原期中总结/任务规划|前端制作/后端制作|前端制作/后端制作|前端制作/后端制作(合并)|debug/整合代码/反观需求|上线试用/修改完善代码|PPT制作/结项总结|

## 4.系统结构设计

### 体系结构图

![体系结构图1](/项目文档/pic/pic1.png)

![体系结构图2](/项目文档/pic/pic2.png)

### 项目大纲(子模块 )设计 具体查看 [outline.md](/项目文档/outline.md)

### 具体逻辑设计 具体查看 [serverDesign.md](/项目文档/serverDesign.md)

### 系统完整性约束设计 具体查看 [约束.md](/项目文档/约束.md)

## 5.接口设计

### 具体查看 [接口配置文件夹/接口配置/*.md](/项目文档/接口配置)

## 6.系统出错处理与维护

### 6.1错误信息返回&自定义异常处理
  
设计相关类在util文件夹内，resultHander文件夹（解决用户使用过程）

根据具体情形返回用户相应提示，及相关网页

### 具体实例参看 [错误处理.md](/项目文档/错误处理.md)

### 6.2补救措施

管理员定期对数据进行备份。采用云磁盘做备份设备。项目采用阿里云部署项目。

#### 阿里云ECS实例快照

阿里云ECS产品提供快照功能，所谓快照，就是保留某个时间点上的系统数据状态，数据盘的快照用于数据备份，系统盘的快照用于制作镜像。快照使用增量的方式，两个快照之间只有数据变化的部分才会被拷贝。推荐用户在以下业务场景中使用快照：

系统盘、数据盘的日常备份，用户可以利用快照定期的对重要业务数据进行备份，来应对误操作、攻击、病毒等导致的数据丢失风险。

更换操作系统，应用软件升级或业务数据迁移等重大操作前，用户可以创建一份或多份数据快照，一旦升级、迁移过程中出现任何问题，可以通过数据快照及时恢复到正常的系统数据状态。

生产数据的多副本应用，用户可以通过对生产数据创建快照，从而为数据挖掘、报表查询、开发测试等应用提供近实时的真实生产数据。

创建快照时，服务器的状态只能为“运行中”或“已停止”。阿里云ECS实例的快照提供两种模式：

自动快照，用户可以通过创建自动快照策略，自定义快照的创建时间、重复时间和保留时间等参数，阿里云系统将定期为指定的磁盘，自动创建快照。

手动快照，用户根据需求，创建磁盘快照。但是，通过手动创建的快照，不会主动删除，会一直保留。

### 6.3系统维护设计

定期重启服务器；服务器优化，包括整理系统空间和性能优化。
系统运行时，应该具有一定的容错能力（如出现错误评判结果后，可以手工评判或者选择重新评判），而且一般的非正常操作不应该影响系统的正常使用。
一旦系统崩溃或出现故障导致系统不能运行，在正常的工作日，应该能够在4个小时内恢复系统正常运行，在节假日等非工作时间，应该能够在24小时内恢复系统正常运行。
周期性地把磁盘信息记录到磁带上去

## 7. 应用技术与技术设计

### 7.1 前端技术参看 [前端技术.md](/项目文档/前端应用技术.md)

### 7.2 后端技术参看 [后端技术.md](/项目文档/后端技术.md)

## 8.  数据库相关设计

### 8.1  数据库管理系统选型

本系统使用MySql5.6作为数据信息管理数据库，安装在服务器端，客户端通过浏览器发送请求给Tomcat服务器，Tomcat服务器接收到请求再访问数据库做相应的CRUD操作。

MySQL 是一个关系型数据库管理系统，由瑞典 MySQL AB 公司开发，目前属于 Oracle 公司。MySQL 最流行的关系型数据库管理系统，在 WEB 应用方面 MySQL 是最好的 RDBMS (Relational Database Management System，关系数据库管理系统) 应用软件之一。MySQL 是一种关联数据库管理系统，关联数据库将数据保存在不同的表中，而不是将所有数据放在一个大仓库内，这样就增加了速度并提高了灵活性。MySQL 所使用的 SQL 语言是用于访问数据库的最常用标准化语言。MySQL 软件采用了双授权政策（本词条“授权政策”），它分为社区版和商业版，由于其体积小、速度快、总体拥有成本低，尤其是开放源码这一特点，一般中小型网站的开发都选择 MySQL 作为网站数据库。

### 数据库具体设计查看 [数据库设计.md](/项目文档/数据库设计.md)

## 9. 故障检测和处理机制

### 9.1  故障检测机制

系统发生故障采用logback记录日志，将error级信息写入日志文件

### 9.2  故障处理机制

系统在业务层采用声明式事务处理，当使用某一业务时，如出现故障，将回滚到数据库前一正常状态，保证后台能继续正常运行，数据库不受到损害。

## 10. 词汇表

|缩写,术语及符号|解 释|
|:------------:|:--:|
|E-R图|逻辑关系图|
|Springboot|Spring组织开发的快捷部署框架|
|界面流|界面访问流程|
| B/S结构|Browser/Server，浏览器/服务器模式|
|MySQL|关系型数据库管理系统|
|SQL语言|结构化查询语言|
|Logback|log4j的升级型日志|
|Redis|一款高性能的非关系数据库|
